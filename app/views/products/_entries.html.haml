-products.in_groups_of(3, false).each do |group|
  .row
    -group.each do |product|
      .col-md-4.col-sm-4.col-xs-4.col-lg-4
        .row
          .col-md-12.col-sm-12.col-xs-12.col-lg-12
            .widewrapper=link_to(image_tag(product.photos.first.image.thumb), product) unless product.photos.count == 0 || product.photos.first.nil?
        .row
          .col-md-12.col-sm-12.col-xs-12.col-lg-12
            .truncate=link_to product.title.titleize, product, title: product.title.titleize, 'data-toggle' => 'tooltip', 'data-placement' => 'top'
        -if product.price
          .row
            .col-md-12.col-sm-12.col-xs-12.col-lg-12
              = 'Price: '
              - if product.sale
                %s.text-muted= number_to_currency product.price
                %br
                .text-success= "Sale: #{number_to_currency product.sale_price}"
              - else
                = number_to_currency product.price
                %br
        .row
          .col-md-12.col-sm-12.col-xs-12.col-lg-12
            -if product.quantity.to_i <= 0
              .text-danger= 'Sold out'
            -else
              %br
        -if current_user.admin
          .row
            .col-md-12.col-sm-12.col-xs-12.col-lg-12
              = link_to( 'Edit', edit_product_path(product), class: "btn btn-primary btn-block")
              = link_to('Destroy', product, :method => :delete, :data => { :confirm => 'Are you sure?' }, class: "btn btn-danger btn-block")
              %br
